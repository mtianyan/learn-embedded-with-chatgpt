✅ 好的，下面是第 8 项课程内容的整理：

---

### **8、自动循迹**

#### 🎯 目标：

掌握循迹模块的工作原理，学习并实现使用 **PID 算法** 控制五路循迹模块，实现小车的 **自动循迹** 功能。

---

#### 📘 知识点：

* **循迹模块原理**：

  * 循迹模块一般为红外反射式，能感知黑线（低反射）和白底（高反射）。
  * 五路循迹模块提供 5 个模拟/数字信号，表示每路是否检测到黑线。

* **采样方式**：

  * 使用 GPIO 或 ADC 读取五路传感器数据。
  * 可采用中值、权重法判断偏移量。

* **小车控制逻辑**：

  * 左偏：右轮加速，左轮减速；
  * 右偏：左轮加速，右轮减速；
  * 偏差为 0：直行。

---

#### 🧮 PID 控制算法：

```c
// 简易 PID 控制器
int PID_Calc(int target, int actual) {
    static int last_error = 0;
    static int integral = 0;
    
    int error = target - actual;
    integral += error;
    int derivative = error - last_error;
    
    int output = Kp * error + Ki * integral + Kd * derivative;
    last_error = error;
    
    return output;
}
```

* `target`：理想的循迹状态（如中间为黑线）；
* `actual`：当前读取到的偏移值；
* `Kp`：比例系数；`Ki`：积分系数；`Kd`：微分系数；
* `output`：用于调整左右电机的速度差。

---

#### 📌 步骤概览：

1. 初始化循迹模块引脚；
2. 定时采集五路数据；
3. 计算实际偏移值（如 -2 \~ +2）；
4. 调用 PID 控制算法，得到修正值；
5. 调整电机 PWM 占空比，实现轨迹保持。

---

#### 📷 示意图：

```
五路循迹模块：
[ L2 ][ L1 ][ C ][ R1 ][ R2 ]
  ↓     ↓     ↓     ↓     ↓
-2     -1     0     +1    +2
```

---

如果你需要：

* 完整代码示例（STM32 HAL 或裸机）；
* PID 参数调试方法；
* 自动循迹调试技巧和常见误差处理；
  我可以继续帮你整理。要不要？
