好的，以下是第9周课程第7项内容：

---

## 7、根文件系统挂载与init进程启动分析

---

### 🎯 课程目标

理解根文件系统的挂载流程，掌握init进程启动及其在系统初始化中的作用。

---

### 1. 根文件系统挂载流程

1. **内核启动完成基本硬件初始化后**

   * 通过内核启动参数（`bootargs`）确定根文件系统设备和类型
   * 常见根文件系统类型：`ext4`、`jffs2`、`ubifs`、`initramfs`等

2. **挂载根文件系统（rootfs）**

   * 内核调用`mount_root()`函数挂载根文件系统
   * 如果是`initramfs`，则直接从内存挂载临时文件系统

3. **挂载成功后**

   * 内核会启动第一个用户空间进程`init`（PID=1）

---

### 2. init进程作用

* **init**是Linux用户空间的第一个进程，负责启动系统的各种服务和守护进程。
* PID为1，所有其他用户进程都是其子进程。

---

### 3. init进程的启动流程（简要）

1. **读取配置文件**

   * `/etc/inittab`（传统SysV init）
   * 或`systemd`的配置文件

2. **挂载必要的虚拟文件系统**

   * `/proc`、`/sys`、`/dev`等

3. **启动系统守护进程**

   * 网络服务、登录服务、定时任务等

4. **进入多用户模式**

   * 根据运行级别启动相应服务

---

### 4. 常见init系统类型

| 类型           | 特点            |
| ------------ | ------------- |
| SysV init    | 传统启动方式，脚本启动服务 |
| systemd      | 现代启动系统，支持并行启动 |
| busybox init | 适合嵌入式系统，轻量简洁  |

---

### 5. init进程的启动代码入口（内核侧）

* 内核调用`kernel_init()`，然后执行`/sbin/init`或`/init`
* 如果`/init`不存在，则会尝试启动`/bin/init`或`/usr/sbin/init`

---

### 6. 相关调试技巧

* 查看启动日志（串口打印）确认根文件系统挂载成功
* 确认`init`进程启动且正常运行
* 使用`ps`查看系统进程状态

---

### 7. 典型挂载参数示例

```
root=/dev/mmcblk0p2 rootfstype=ext4 rootwait console=ttyS0,115200
```

* `root`：根文件系统设备
* `rootfstype`：文件系统类型
* `rootwait`：等待设备准备好再挂载
* `console`：指定控制台串口

---

需要我帮你准备某嵌入式板卡根文件系统挂载示例或`init`进程详细启动脚本解析吗？
